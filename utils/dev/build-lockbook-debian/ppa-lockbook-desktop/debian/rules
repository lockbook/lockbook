#!/usr/bin/make -f

clean:
	dh clean

build:
	dh build
	curl https://sh.rustup.rs -sSf | bash -s -- -y
	(export PATH="/root/.cargo/bin:$$PATH" && cargo build --release --manifest-path ../../../../clients/linux/Cargo.toml)

binary:
	mkdir -p debian/lockbook-desktop/usr/bin
	mkdir -p debian/lockbook-desktop/usr/share/applications
	mkdir -p debian/lockbook-desktop/usr/share/pixmaps

	cp ../../../../clients/linux/target/release/lockbook debian/lockbook-desktop/usr/bin/lockbook-desktop
	cp lockbook-desktop.desktop debian/lockbook-desktop/usr/share/applications
	cp ../../../../graphics/SVGs/dark-1.svg debian/lockbook-desktop/usr/share/pixmaps

	strip --strip-all debian/lockbook-desktop/usr/bin/lockbook-desktop
	dh_gencontrol
	dh_builddeb
